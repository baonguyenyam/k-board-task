"use strict";function __addTask_submitForm(){$("#datepicker").datetimepicker({controlType:"select",oneLine:!0,dateFormat:"yy-mm-dd",timeFormat:"HH:mm"}),$("#customFile").on("change paste keyup",function(e){var t=e.target.files[0].name;$("#customFileLabel").html(t)}),$("form.validator").validator().on("submit",function(e){return e.isDefaultPrevented()?alert("Vui lòng kiểm tra lại thông tin"):(App.txtNewTitle=$("#text").val(),App.txtNewSelect=$("#select").val(),App.txtNewMesage=$("#message").val(),App.txtNewDate=$("#datepicker").val(),App.txtNewProject=$("#namepro").val(),App.txtNewColor=$("#color").val(),App.txtNewMaterial=$("#material").val(),upLoadPDF(App.txtNewTitle,App.txtNewSelect,App.txtNewMesage,App.txtNewDate,App.txtNewProject,App.txtNewColor,App.txtNewMaterial)),!1})}function __addTask_createTask(e,t,a,o,r,n,c,i){var l=JSON.stringify({ObjectId:null,ObjectType:"cnc.task",Name:e,MetaIndex:t,MetaBitValue:null,MetaDescription:a,MetaTextValue:r,CreatedDate:o,Properties:{JobDetail:{Project:n,Material:i,PaintColor:c}}});$.ajax({url:Global.API_URL+"/etracking/cnctask/save",type:"PUT",async:!0,dataType:"json",cache:!0,data:l,contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+localStorage.getItem("Token"))},error:function(e,t,a){},complete:function(e){var t=e.responseJSON.ObjectId;$.ajax({url:Global.API_URL+"/etracking/cnctask/setstate?jobid="+t+"&newState=P&returnAllStates=true",type:"POST",async:!0,dataType:"json",cache:!0,contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+localStorage.getItem("Token"))},complete:function(e){}})}})}function upLoadPDF(t,a,o,r,n,c,i){var e=new FormData($("#addtask")[0]);return $.ajax({url:"/upload",type:"POST",contentType:!1,processData:!1,cache:!1,data:e,success:function(e){__addTask_createTask(t,a,o,r,e,n,c,i),alert("Đã cập nhật task mới!"),$("#addtask")[0].reset()},error:function(){alert("Lỗi khi upload!")}}),!1}$(document).ready(function(){__addTask_submitForm()});