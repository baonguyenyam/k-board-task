"use strict";function __delTask(){var e=getParameterByName("id");if(!confirm("Bạn có chắc chắn xóa task này?"))return!1;$.ajax({url:Global.API_URL+"/etracking/cnctask/setstate?jobid="+e+"&newState=N&returnAllStates=true",type:"POST",async:!0,dataType:"json",cache:!0,contentType:"application/json; charset=utf-8",beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+localStorage.getItem("Token"))},complete:function(e){window.location.href="/"}})}function __gettask_getLists(){var e=getParameterByName("id");$.ajax({url:Global.API_URL+"/etracking/cnctask/getjob?jobid="+e,type:"GET",async:!0,dataType:"json",cache:!0,beforeSend:function(e){e.setRequestHeader("Authorization","Bearer "+localStorage.getItem("Token"))},error:function(e,t,a){},complete:function(e){var t="secondary";for(var a in 1==e.responseJSON.MetaIndex?t="primary":2==e.responseJSON.MetaIndex?t="success":3==e.responseJSON.MetaIndex&&(t="danger"),$(".taskdetails .card").addClass("border-"+t),$(".taskdetails .card-header").addClass("bg-"+t),e.responseJSON)if(e.responseJSON.hasOwnProperty(a)){var s=e.responseJSON[a];"createddate"===a.toLowerCase()?$("#data-"+a.toLowerCase()).html(moment(checkNull(s)).format("DD/MM/YYYY")+" lúc "+moment(checkNull(s)).format("HH:MM")):$("#data-"+a.toLowerCase()).html(checkNull(s)),$("#key-"+a.toLowerCase()).html(checkNull(a))}for(var o in e.responseJSON.Properties.JobDetail)if(e.responseJSON.Properties.JobDetail.hasOwnProperty(o)){s=e.responseJSON.Properties.JobDetail[o];$("#data-jobdetail-"+o.toLowerCase()).html(checkNull(s)),$("#key-jobdetail-"+o.toLowerCase()).html(checkNull(o))}for(var r in e.responseJSON.Properties.JobStates[0])if(e.responseJSON.Properties.JobStates[0].hasOwnProperty(r)){s=e.responseJSON.Properties.JobStates[0][r];"activatedts"===r.toLowerCase()?$("#data-jobstates-"+r.toLowerCase()).html(moment(checkNull(s)).format("DD/MM/YYYY")+" lúc "+moment(checkNull(s)).format("HH:MM")):$("#data-jobstates-"+r.toLowerCase()).html(checkNull(s)),$("#key-jobstates-"+r.toLowerCase()).html(checkNull(r))}var n='<span class="badge badge-light p-1">Không hiệu lực</span>';"P"===e.responseJSON.Properties.JobStates[0].State?n='<span class="badge badge-secondary p-1">Nhiệm vụ</span>':"I"===e.responseJSON.Properties.JobStates[0].State?n='<span class="badge badge-info p-1">Đang thực thi</span>':"D"===e.responseJSON.Properties.JobStates[0].State&&(n='<span class="badge badge-success p-1">Hoàn thành</span>'),$("#jobstates-state").html(n),$("#pdffiles").attr("href","/files/"+e.responseJSON.MetaTextValue)}})}$(document).ready(function(){__gettask_getLists()});